{% extends 'app_main/_base.html' %}

{% block title %}–û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤—Å–µ–º{% endblock %}

{% block header %}–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –≤–æ –≤—Å–µ —á–∞—Ç—ã{% endblock %}

{% block body %}
<section>
    <div class="card">
        <h2>–û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤–æ –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —á–∞—Ç—ã</h2>
        <form method="post">
            {% csrf_token %}

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ - –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è -->
                <div>
                    <div class="form-group">
                        <label for="message">–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è:</label>
                        <textarea id="message" name="message" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç, –∫–æ—Ç–æ—Ä—ã–π —Ö–æ—Ç–∏—Ç–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å...">{% if request.POST.message %}{{ request.POST.message }}{% endif %}</textarea>
                        <small>–≠—Ç–æ—Ç —Ç–µ–∫—Å—Ç –±—É–¥–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–º —Å–æ–æ–±—â–µ–Ω–∏–µ–º</small>
                    </div>
                </div>

                <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ - –°—Å—ã–ª–∫–∏ -->
                <div>
                    <div class="form-group">
                        <label for="links">–°—Å—ã–ª–∫–∏ (–∫–∞–∂–¥–∞—è —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏):</label>
                        <textarea id="links" name="links" placeholder="https://example.com/link1&#10;https://example.com/link2&#10;https://example.com/link3">{% if request.POST.links %}{{ request.POST.links }}{% endif %}</textarea>
                        <small>–ö–∞–∂–¥–∞—è —Å—Å—ã–ª–∫–∞ —Å –Ω–æ–≤–æ–π —Å—Ç—Ä–æ–∫–∏. –ë—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –∫–æ–Ω—Ü–µ —Å–æ–æ–±—â–µ–Ω–∏—è</small>
                    </div>
                </div>
            </div>

            <div style="background: #fff3cd; padding: 15px; border-radius: 4px; border: 1px solid #ffeaa7; margin: 15px 0;">
                <strong>‚ö†Ô∏è –í–Ω–∏–º–∞–Ω–∏–µ!</strong> –°–æ–æ–±—â–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –≤–æ –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —á–∞—Ç—ã (–≤—Å–µ–≥–æ: {{ chats.count }}).
            </div>

            <div style="text-align: center;">
                <button type="submit" class="button button-warning">üöÄ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤–æ –≤—Å–µ —á–∞—Ç—ã</button>
                <a href="{% url 'app_next:send_message' %}" class="button">üì® –í—ã–±—Ä–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —á–∞—Ç—ã</a>
            </div>
        </form>
    </div>
</section>

{% if results %}
<section>
    <div class="card">
        <h2>–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç–ø—Ä–∞–≤–∫–∏</h2>
        <div style="overflow-x: auto;">
            <table style="width: 100%; border-collapse: collapse;">
                <thead>
                    <tr style="background: #f8f9fa;">
                        <th style="padding: 12px; text-align: left; border-bottom: 2px solid #ddd;">–ß–∞—Ç</th>
                        <th style="padding: 12px; text-align: left; border-bottom: 2px solid #ddd;">–°—Ç–∞—Ç—É—Å</th>
                        <th style="padding: 12px; text-align: left; border-bottom: 2px solid #ddd;">–î–µ—Ç–∞–ª–∏</th>
                    </tr>
                </thead>
                <tbody>
                    {% for result in results %}
                    <tr>
                        <td style="padding: 12px; border-bottom: 1px solid #eee;">{{ result.chat }}</td>
                        <td style="padding: 12px; border-bottom: 1px solid #eee;">
                            <span style="display: inline-block; padding: 4px 8px; border-radius: 4px;
                                background: {% if result.status == 'success' %}#d4edda{% else %}#f8d7da{% endif %};
                                color: {% if result.status == 'success' %}#155724{% else %}#721c24{% endif %};">
                                {{ result.status }}
                            </span>
                        </td>
                        <td style="padding: 12px; border-bottom: 1px solid #eee;">
                            {% if result.status_code %}HTTP {{ result.status_code }}{% endif %}
                            {% if result.error %}{{ result.error }}{% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</section>
{% endif %}
{% endblock %}